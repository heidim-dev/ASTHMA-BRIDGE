##########Premerge checks########
LstCampChips1to68
## $es.raw
## Summary of data information:
## Data File Information:
## GSGX Version 1.7.0
## Report Date 5/2/2011 10:05:40 AM
## Project CAMP_Chips1-68_042911
## Group Set CAMP_Chips1-68_042911
## Analysis CAMP_Chips1-68_042911
## Normalization none
##
## Major Operation History:
## submitted finished
## 1 2013-01-23 19:19:13 2013-01-23 19:24:40
## 2 2013-01-23 19:24:40 2013-01-23 19:24:52
## 3 2013-01-23 19:25:12 2013-01-23 19:25:21
## 4 2013-01-23 19:25:26 2013-01-23 19:25:36
## 5 2013-01-23 19:25:41 2013-01-23 19:25:50
## ## 1 lumiR("/proj/reilms/reilm00/GX/HumanHT12_V4/CAMP_All68Chips_Spring2011/Arrays//CAMP_Chips1-68_SampleProbeProfile.## 2 ## 3 ## 4 ## 5 ## lumiVersion
## 1 2.10.0
## 2 2.10.0
## 3 2.10.0
## 4 2.10.0
## 5 2.10.0
##
## Object Information:
## LumiBatch (storageMode: lockedEnvironment)
## assayData: 47149 features, 816 samples
## element names: beadNum, detection, exprs, se.exprs
## protocolData: none
## phenoData
## sampleNames: ST-00062678_S-000531211_5452276022_A
## ST-00062779_S-000531213_5452276022_B ...
## ST-00062056_S-000535736_5859738067_L (816 total)
## varLabels: Tracking_Barcode Hybridization_Name ... Comments (38
## total)
## varMetadata: labelDescription
## featureData
## featureNames: GCCCTGACCTTCATGGTGTCTTTGAAGCCCAACCACTCGGTTTCCTTCGG
## GGATTTCCTACACTCTCCACTTCTGAATGCTTGGAAACACTTGCCATGCT ...
## GCCCAGGCACAGACCCTGATAGTGGGTTTGGGTCACCTTGGTATGGAATG (47149
## total)
## fvarLabels: ProbeID TargetID ... Obsolete_Probe_Id (29 total)
## fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation:
## Control Data: Available
## QC information: Please run summary(x, 'QC') for details!
##
## $esQC.raw
## Summary of data information:
## Data File Information:
## GSGX Version 1.7.0
## Report Date 5/2/2011 10:13:16 AM
## Project CAMP_Chips1-68_042911
## Group Set CAMP_Chips1-68_042911
## Analysis CAMP_Chips1-68_042911
## Normalization none
##
## Major Operation History:
## submitted finished
## 1 2013-01-23 19:25:51 2013-01-23 19:26:03
## 2 2013-01-23 19:26:03 2013-01-23 19:26:03
## 3 2013-01-23 19:26:22 2013-01-23 19:26:22
## 4 2013-01-23 19:26:23 2013-01-23 19:26:23
## 5 2013-01-23 19:26:23 2013-01-23 19:26:23
## ## 1 lumiR("/proj/reilms/reilm00/GX/HumanHT12_V4/CAMP_All68Chips_Spring2011/Arrays//CAMP_Chips1-68_QCProbeProfile)
## 2 ## 3 ## 4 ## 5 ## lumiVersion
## 1 2.10.0
## 2 2.10.0
## 3 2.10.0
## 4 2.10.0
## 5 2.10.0
##
## Object Information:
## LumiBatch (storageMode: lockedEnvironment)
## assayData: 881 features, 816 samples
## element names: beadNum, detection, exprs, se.exprs
## protocolData: none
## phenoData
## sampleNames: ST-00062678_S-000531211_5452276022_A
## ST-00062779_S-000531213_5452276022_B ...
## ST-00062056_S-000535736_5859738067_L (816 total)
## varLabels: Tracking_Barcode Hybridization_Name ... Comments (38
## total)
## varMetadata: labelDescription
## featureData
## featureNames: GAGCTCTCCTGTATGCCTATGATCTGCCTTCTGTCGCACTCGCCCAGTGT
## CTTACCCCAGTGACTAAGGACCCGGACTGGGGGGCTGTATCACGGATTAC ...
## CCACACTTCTCGGGCCCGTCCGGACTCATCTTTGACAGAACGCCCATAAA (881 total)
## fvarLabels: ProbeID TargetID ... Probe_Sequence (7 total)
## fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation:
## Control Data: Available
## QC information: Please run summary(x, 'QC') for details!
colnames(pData(es.raw.camp))
## [1] "Tracking_Barcode" "Hybridization_Name"
## [3] "Treatment_Type" "Subject_ID"
## [5] "Gender" "Recruitment_ID"
## [7] "Study_Name" "Study_Center_Name"
## [9] "Specimen_Date_Collected" "RNA_Conc"
## [11] "RNA_Quant_Date" "RNA_Quant_Tech"
## [13] "RNA_Conc_Method" "RNA_Ext_Date"
## [15] "RNA_Ext_Tech" "RNA_Ratio"
## [17] "Quality_Rank" "IVT_Batch_Id"
## [19] "IVT_Run_Date" "IVT_Conc"
## [21] "IVT_Conc_Method" "IVT_Tech"
## [23] "Chip_Batch_Id" "Batch_Run_Date"
## [25] "Chip_Name" "Chip_Barcode"
## [27] "Chip_Address" "Hyb_Cond"
## [29] "Treatments" "Replicate_Sample"
## [31] "Repeat_Sample" "Dried_Down"
## [33] "Pass_Fail" "Chip_Version"
## [35] "Batch_Tech" "Chip_Manifest"
## [37] "Beadstudio_Software_Version" "Comments"
#########1956 arrays containing 47160 regular probes and 880 QC probes#########
## $es.raw
## Summary of data information:
## Data File Information:
## GSGX Version 1.7.0
## Report Date 5/9/2012 7:49:00 AM
## Project GS_Files_Chips_1_163
## Group Set ABRIG Chips 1-163
LstAbridgeChips1to163
## $es.raw
## Summary of data information:
## Data File Information:
## GSGX Version 1.7.0
## Report Date 5/9/2012 7:49:00 AM
## Project GS_Files_Chips_1_163
## Group Set ABRIG Chips 1-163
## Analysis ABRIG Chips 1-163
## Normalization none
##
## Major Operation History:
## submitted finished
## 1 2013-01-23 19:27:58 2013-01-23 19:39:34
## 2 2013-01-23 19:39:34 2013-01-23 19:40:03
## 3 2013-01-23 19:40:32 2013-01-23 19:40:57
## 4 2013-01-23 19:41:07 2013-01-23 19:41:34
## ## 1 lumiR("/proj/reilms/reilm00/GX/HumanHT12_V4/ABRIGE/ABRIG_163Chips_May2012/ABRIG_ALLChips_1_163_SampleProbeProfile.## 2 ## 3 ## 4 ## lumiVersion
## 1 2.10.0
## 2 2.10.0
## 3 2.10.0
## 4 2.10.0
##
## Object Information:
## LumiBatch (storageMode: lockedEnvironment)
## assayData: 47160 features, 1956 samples
## element names: beadNum, detection, exprs, se.exprs
## protocolData: none
## phenoData
## sampleNames: ST-01000076_S-001001264_5447346015_A
## ST-01000076_S-001001265_5447346015_B ...
## ST-01005912_S-001122544_7649558061_L (1956 total)
## varLabels: Tracking_Barcode Hybridization_Name ... ABRIG_Batch
## (42 total)
## varMetadata: labelDescription
## featureData
## featureNames: GCCCTGACCTTCATGGTGTCTTTGAAGCCCAACCACTCGGTTTCCTTCGG
## GGATTTCCTACACTCTCCACTTCTGAATGCTTGGAAACACTTGCCATGCT ...
## GCCCAGGCACAGACCCTGATAGTGGGTTTGGGTCACCTTGGTATGGAATG (47160
## total)
## fvarLabels: ProbeID TargetID ... Obsolete_Probe_Id (29 total)
## fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation:
## Control Data: Available
## QC information: Please run summary(x, 'QC') for details!
##
## $esQC.raw
## Summary of data information:
## Data File Information:
## GSGX Version 1.7.0
## Report Date 5/9/2012 7:48:06 AM
## Project GS_Files_Chips_1_163
## Group Set ABRIG Chips 1-163
## Analysis ABRIG Chips 1-163
## Normalization none
##
## Major Operation History:
## submitted finished
## 1 2013-01-23 19:41:34 2013-01-23 19:42:58
## 2 2013-01-23 19:42:58 2013-01-23 19:42:58
## 3 2013-01-23 19:43:17 2013-01-23 19:43:17
## 4 2013-01-23 19:43:18 2013-01-23 19:43:18
## 5 2013-01-23 19:43:19 2013-01-23 19:43:19
## ## 1 lumiR("/proj/reilms/reilm00/GX/HumanHT12_V4/ABRIGE/ABRIG_163Chips_May2012/ABRIG_ALLChips_1_163_QCProbeProfile.## 2 ## 3 ## 4 ## 5 ## lumiVersion
## 1 2.10.0
## 2 2.10.0
## 3 2.10.0
## 4 2.10.0
## 5 2.10.0
##
## Object Information:
## LumiBatch (storageMode: lockedEnvironment)
## assayData: 880 features, 1956 samples
## element names: beadNum, detection, exprs, se.exprs
## protocolData: none
## phenoData
## sampleNames: ST-01000076_S-001001264_5447346015_A
## ST-01000076_S-001001265_5447346015_B ...
## ST-01005912_S-001122544_7649558061_L (1956 total)
## varLabels: Tracking_Barcode Hybridization_Name ... ABRIG_Batch
## (42 total)
## varMetadata: labelDescription
## featureData
## featureNames: GAGCTCTCCTGTATGCCTATGATCTGCCTTCTGTCGCACTCGCCCAGTGT
## CTTACCCCAGTGACTAAGGACCCGGACTGGGGGGCTGTATCACGGATTAC ...
## CCACACTTCTCGGGCCCGTCCGGACTCATCTTTGACAGAACGCCCATAAA (880 total)
## fvarLabels: ProbeID TargetID ... Probe_Sequence (7 total)
## fvarMetadata: labelDescription
## experimentData: use 'experimentData(object)'
## Annotation:
## Control Data: Available
## QC information: Please run summary(x, 'QC') for details!
colnames(pData(es.raw.abridge))
## [1] "Tracking_Barcode" "Hybridization_Name"
## [3] "Treatment_Type" "Tissue_Descr"
## [5] "Subject_ID" "Unique_ID"
## [7] "Gender" "Recruitment_ID"
## [9] "Study_Name" "Study_Center_Name"
## [11] "Specimen_Date_Collected" "RNA_Conc"
## [13] "RNA_Quant_Date" "RNA_Quant_Tech"
## [15] "RNA_Conc_Method" "RNA_Ext_Date"
## [17] "RNA_Ext_Tech" "RNA_Ratio"
## [19] "Quality_Rank" "IVT_Batch_Id"
## [21] "IVT_Run_Date" "IVT_Conc"
## [23] "IVT_Conc_Method" "IVT_Tech"
## [25] "Chip_Batch_Id" "Batch_Run_Date"
## [27] "Chip_Name" "Chip_Barcode"
## [29] "Chip_Address" "Hyb_Cond"
## [31] "Treatments" "Replicate_Sample"
## [33] "Repeat_Sample" "Dried_Down"
## [35] "Gender_Mismatch" "Pass_Fail"
## [37] "Chip_Version" "Batch_Tech"
## [39] "Chip_Manifest" "Beadstudio_Software_Version"
## [41] "Comments" "ABRIG_Batch"
#####Study center names from CAMP altered to be consistent with Asthma BRIDGE###
scn.camp <- es.raw.camp$Study_Center_Name
which.jhu <- which(es.raw.camp$Study_Center_Name == "JHU - Johns Hopkins University")
which.njmrc <- which(es.raw.camp$Study_Center_Name == "NJMRC - National Jewish Medical Research Center")
which.wu <- which(es.raw.camp$Study_Center_Name == "WU - Washington University")
scn.camp[which.jhu] <- "JH - John Hopkins University"
scn.camp[which.njmrc] <- "NJMRC - National Jewish Medical Research Center"
scn.camp[which.wu] <- "WU CARE - Washington University"
es.raw.camp$Study_Center_Name <- scn.camp
esQC.raw.camp$Study_Center_Name <- scn.camp
###Label sets between datasets
####Comparison between CAMP and Asthma BRIDGE####
fDat.camp <- fData(es.raw.camp)
fDat.abridge <- fData(es.raw.abridge)
setdiff(colnames(fDat.abridge), colnames(fDat.camp))
## character(0)
setdiff(colnames(fDat.camp), colnames(fDat.abridge))
## character(0)
# We then compared the phenotype sets of the CAMP and ABRIDGE data.
pDat.camp <- pData(es.raw.camp)
pDat.abridge <- pData(es.raw.abridge)
setdiff(colnames(pDat.abridge), colnames(pDat.camp))
## [1] "Tissue_Descr" "Unique_ID" "Gender_Mismatch" "ABRIG_Batch"
setdiff(colnames(pDat.camp), colnames(pDat.abridge))
## character(0)
###We renamed the CAMP treatment types and added to the the CAMP phenotype data columns of gender##
# mismatch flags and ABRIDGE batch IDs containing empty values.
td.camp <- rep(NA, nrow(pDat.camp))
td.camp[pDat.camp$Treatment_Type == "Blood_Paxgene RNA"] <- "Pax_RNA"
td.camp[pDat.camp$Treatment_Type == "Cell Line for Stock_NA"] <- "HeLa"
es.raw.camp$Tissue_Descr <- td.camp
esQC.raw.camp$Tissue_Descr <- td.camp
es.raw.camp$Gender_Mismatch <- rep(NA, nrow(pDat.camp))
es.raw.camp$ABRIG_Batch <- rep(NA, nrow(pDat.camp))
esQC.raw.camp$Gender_Mismatch <- rep(NA, nrow(pDat.camp))
##We renamed the CAMP treatment types and added to the the CAMP phenotype data columns of gender
##mismatch flags and ABRIDGE batch IDs containing empty values.
td.camp <- rep(NA, nrow(pDat.camp))
td.camp[pDat.camp$Treatment_Type == "Blood_Paxgene RNA"] <- "Pax_RNA"
td.camp[pDat.camp$Treatment_Type == "Cell Line for Stock_NA"] <- "HeLa"
es.raw.camp$Tissue_Descr <- td.camp
esQC.raw.camp$Tissue_Descr <- td.camp
es.raw.camp$Gender_Mismatch <- rep(NA, nrow(pDat.camp))
es.raw.camp$ABRIG_Batch <- rep(NA, nrow(pDat.camp))
esQC.raw.camp$Gender_Mismatch <- rep(NA, nrow(pDat.camp))
esQC.raw.camp$ABRIG_Batch <- rep(NA, nrow(pDat.camp))
es.raw.camp$Unique_ID <- paste(es.raw.camp$Subject_ID, es.raw.camp$Tissue_Descr,
                               sep = "")
esQC.raw.camp$Unique_ID <- paste(esQC.raw.camp$Subject_ID, esQC.raw.camp$Tissue_Descr,
                                 sep = "")
pDat.camp <- pData(es.raw.camp)
pDat.abridge <- pData(es.raw.abridge)

# The phenotype sets were concordant between the two datasets.
setdiff(colnames(pDat.abridge), colnames(pDat.camp))
## character(0)
setdiff(colnames(pDat.camp), colnames(pDat.abridge))
## character(0)
##We next re-ordered the CAMP phenotype set based on their order in the ABRIDGE data.
pos <- match(colnames(pDat.abridge), colnames(pDat.camp))
pDat.camp2 <- pDat.camp[, pos]
rownames(pDat.camp2) <- rownames(pDat.camp)
pData(es.raw.camp) <- pDat.camp2
pData(esQC.raw.camp) <- pDat.camp2
# We confirmed that the two phenotype sets were now in the same order (identical = TRUE). We also
# checked that the column modes were matching.
ttflag <- rep(0, ncol(pDat.camp))
for (i in 1:ncol(pDat.camp)) {
  cni <- colnames(pDat.camp)[i]
  cat("\n**** ", cni, " ***\n")
  cat("Mode in CAMP =", mode(pDat.camp[, i]), ", Mode in ABRIDGE =", mode(pDat.abridge[,
                                                                                       i]), "\n")
  if (mode(pDat.camp[, i]) != mode(pDat.abridge[, i])) {
    ttflag[i] <- 1
  }
}
str(pDat.camp2)
str(pDat.abridge)
##########
##########
###We then explicitly harmonized the data types for each column between the CAMP and ABRIDGE data.###
es.raw.camp$RNA_Conc <- as.numeric(es.raw.camp$RNA_Conc)
esQC.raw.camp$RNA_Conc <- as.numeric(esQC.raw.camp$RNA_Conc)
es.raw.camp$RNA_Quant_Date <- as.character(es.raw.camp$RNA_Quant_Date)
es.raw.camp$RNA_Quant_Tech <- as.character(es.raw.camp$RNA_Quant_Tech)
es.raw.camp$Comments <- as.character(es.raw.camp$Comments)
es.raw.camp$Gender_Mismatch <- as.character(es.raw.camp$Gender_Mismatch)
es.raw.camp$ABRIG_Batch <- as.character(es.raw.camp$ABRIG_Batch)
esQC.raw.camp$RNA_Quant_Date <- as.character(esQC.raw.camp$RNA_Quant_Date)
esQC.raw.camp$RNA_Quant_Tech <- as.character(esQC.raw.camp$RNA_Quant_Tech)
esQC.raw.camp$Comments <- as.character(esQC.raw.camp$Comments)
esQC.raw.camp$Gender_Mismatch <- as.character(esQC.raw.camp$Gender_Mismatch)
esQC.raw.camp$ABRIG_Batch <- as.character(esQC.raw.camp$ABRIG_Batch)
es.raw.abridge$RNA_Conc <- as.numeric(es.raw.abridge$RNA_Conc)
esQC.raw.abridge$RNA_Conc <- as.numeric(esQC.raw.abridge$RNA_Conc)
es.raw.abridge$RNA_Quant_Date <- as.character(es.raw.abridge$RNA_Quant_Date)
es.raw.abridge$RNA_Quant_Tech <- as.character(es.raw.abridge$RNA_Quant_Tech)
es.raw.abridge$Comments <- as.character(es.raw.abridge$Comments)
es.raw.abridge$Gender_Mismatch <- as.character(es.raw.abridge$Gender_Mismatch)
es.raw.abridge$ABRIG_Batch <- as.character(es.raw.abridge$ABRIG_Batch)
esQC.raw.abridge$RNA_Quant_Date <- as.character(esQC.raw.abridge$RNA_Quant_Date)
esQC.raw.abridge$RNA_Quant_Tech <- as.character(esQC.raw.abridge$RNA_Quant_Tech)
esQC.raw.abridge$Comments <- as.character(esQC.raw.abridge$Comments)
esQC.raw.abridge$Gender_Mismatch <- as.character(esQC.raw.abridge$Gender_Mismatch)
esQC.raw.abridge$ABRIG_Batch <- as.character(esQC.raw.abridge$ABRIG_Batch)
es.raw.camp$Beadstudio_Software_Version <- as.character(es.raw.camp$Beadstudio_Software_Version)
es.raw.camp$ABRIG_Batch <- as.character(es.raw.camp$ABRIG_Batch)
esQC.raw.camp$Beadstudio_Software_Version <- as.character(esQC.raw.camp$Beadstudio_Software_Version)
esQC.raw.camp$ABRIG_Batch <- as.character(esQC.raw.camp$ABRIG_Batch)
es.raw.abridge$Beadstudio_Software_Version <- as.character(es.raw.abridge$Beadstudio_Software_Version)
es.raw.abridge$ABRIG_Batch <- as.character(es.raw.abridge$ABRIG_Batch)
esQC.raw.abridge$Beadstudio_Software_Version <- as.character(esQC.raw.abridge$Beadstudio_Software_Version)
esQC.raw.abridge$ABRIG_Batch <- as.character(esQC.raw.abridge$ABRIG_Batch)
pDat.camp <- pData(es.raw.camp)
pDat.abridge <- pData(es.raw.abridge)
fDat.camp <- fData(es.raw.camp)
fDat.abridge <- fData(es.raw.abridge)

####################
###################
ttflag <- rep(0, ncol(pDat.camp))
for (i in 1:ncol(pDat.camp)) {
  cni <- colnames(pDat.camp)[i]
  cat("\n**** ", cni, " ***\n")
  cat("Mode in CAMP =", mode(pDat.camp[, i]), ", Mode in ABRIDGE =", mode(pDat.abridge[,
                                                                                       i]), "\n")
  if (mode(pDat.camp[, i]) != mode(pDat.abridge[, i])) {
    ttflag[i] <- 1
  }
}
##
## **** Tracking_Barcode ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Hybridization_Name ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Treatment_Type ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Tissue_Descr ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Subject_ID ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Unique_ID ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Gender ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Recruitment_ID ***
## Mode in CAMP = numeric , Mode in ABRIDGE = numeric
##
## **** Study_Name ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Study_Center_Name ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Specimen_Date_Collected ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** RNA_Conc ***
## Mode in CAMP = numeric , Mode in ABRIDGE = numeric
##
## **** RNA_Quant_Date ***
## Mode in CAMP = character , Mode in ABRIDGE = character
#### **** RNA_Quant_Tech ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** RNA_Conc_Method ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** RNA_Ext_Date ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** RNA_Ext_Tech ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** RNA_Ratio ***
## Mode in CAMP = numeric , Mode in ABRIDGE = numeric
##
## **** Quality_Rank ***
## Mode in CAMP = numeric , Mode in ABRIDGE = numeric
##
## **** IVT_Batch_Id ***
## Mode in CAMP = numeric , Mode in ABRIDGE = numeric
##
## **** IVT_Run_Date ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** IVT_Conc ***
## Mode in CAMP = numeric , Mode in ABRIDGE = numeric
##
## **** IVT_Conc_Method ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** IVT_Tech ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Chip_Batch_Id ***
## Mode in CAMP = numeric , Mode in ABRIDGE = numeric
##
## **** Batch_Run_Date ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Chip_Name ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Chip_Barcode ***
## Mode in CAMP = numeric , Mode in ABRIDGE = numeric
##
## **** Chip_Address ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Hyb_Cond ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Treatments ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Replicate_Sample ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Repeat_Sample ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Dried_Down ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Gender_Mismatch ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Pass_Fail ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Chip_Version ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Batch_Tech ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Chip_Manifest ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Beadstudio_Software_Version ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** Comments ***
## Mode in CAMP = character , Mode in ABRIDGE = character
##
## **** ABRIG_Batch ***
## Mode in CAMP = character , Mode in ABRIDGE = character
setdiff(colnames(pDat.camp), colnames(pDat.abridge))
## character(0)
setdiff(colnames(pDat.abridge), colnames(pDat.camp))
## character(0)
str(pDat.camp)
str(pDat.abridge)
setdiff(featureNames(es.raw.camp), featureNames(es.raw.abridge))
setdiff(featureNames(esQC.raw.camp), featureNames(esQC.raw.abridge))
setdiff(featureNames(es.raw.abridge), featureNames(es.raw.camp))
setdiff(featureNames(esQC.raw.abridge), featureNames(esQC.raw.camp))
#######Data merging and post-merge checks
# merge two LumiBatch objects
es.raw <- myCombine(x = es.raw.camp, y = es.raw.abridge, combineRule = "intersection")
## Two objects have different feature names.
## Warning: Two objects have different featureNames, only the common ones were used.
## Warning: chipver.x not equal to chipver.y!
## Warning: Two controlData objects have different rownames, only the common ones were used.
##We removed the duplicate probe labels.
fData(es.raw) <- fData(es.raw)[, 1:ncol(fData(es.raw.camp))]
##We then confirmed their successful removal.
colnames(fData(es.raw))
##We then merged together the CAMP and ABRIDGE datasets for the QC probes as above.
esQC.raw <- myCombine(x = esQC.raw.camp, y = esQC.raw.abridge, combineRule = "intersection")
## Two objects have different feature names.
## Warning: Two objects have different featureNames, only the common ones were used.
## Warning: chipver.x not equal to chipver.y!
## Warning: Two controlData objects have different rownames, only the common ones were used.
##We then examined the phenotype set and probe labels for the merged QC dataset.
colnames(pData(esQC.raw))
colnames(fData(esQC.raw))
##We removed the duplicate probe labels.
fData(esQC.raw) <- fData(esQC.raw)[, 1:ncol(fData(esQC.raw.camp))]
##We then confirmed their successful removal.
colnames(pData(esQC.raw))
colnames(fData(esQC.raw))
##The two merged datasets were then combined into a single list object.
LstCampChips1to60AbridgeChips1to163 <- list(es.raw = es.raw, esQC.raw = esQC.raw)
##We then merged into the expression data set additional questionnaire data from an external file. First, we
##made working copies of the datasets.
es.raw <- LstCampChips1to60AbridgeChips1to163$es.raw
esQC.raw <- LstCampChips1to60AbridgeChips1to163$esQC.raw
colnames(pData(esQC.raw))
colnames(fData(esQC.raw))
pheno <- read.csv(file = "/proj/reilms/reilm0h/ABRIDGE_GeneExpr_Final/Input/abridge_en_sp.e2_dist.csv",
                  header = TRUE, stringsAsFactors = FALSE)
count.quest.phenos <- dim(pheno)[2]
count.quest.arrays <- dim(pheno)[1]
colnames(pheno)
##All of the IDs in this file are ABRIDGE IDs.
# all Id in pheno are ABRIDGE ID
pheno$Id
esQC.raw$Recruitment_ID[which(esQC.raw$Study_Name == "CAMP")]
esQC.raw$Recruitment_ID[which(esQC.raw$Study_Name == "ABRIG")]
esQC.raw$Recruitment_ID[which(esQC.raw$Study_Name == "CONTRL")]
##We then read in an ID conversion table to replace the non-ABRIDGE IDs with ABRIDGE IDs.
idmap <- read.csv(file = "/proj/reilms/reilm0h/ABRIDGE_GeneExpr_Final/Input/abridge_id_map.csv",
                  header = TRUE, stringsAsFactors = FALSE)
idmap[1:2, ]
##We then determined whether each CAMP array had an ABRIDGE ID.
pos.camp <- which(esQC.raw$Study_Name == "CAMP")
campid <- esQC.raw$Recruitment_ID[pos.camp]
ttpos <- match(campid, idmap$CAMP)
ttpos2 <- which(is.na(ttpos) == TRUE)
ttpos3 <- ttpos[-ttpos2]
campid2 <- campid
campid2[-ttpos2] <- idmap$ABRIDGE_IID[ttpos3]
##We confirmed that the ID mappings are accurate in the first 20 arrays.
ttframe <- data.frame(campid = campid, campid2 = campid2)
ttframe[1:20, ]
idmap[ttpos3[1:20], ]
##In the QC dataset, we replaced the CAMP recruitment IDs with the ABRIDGE IDs.
esQC.raw$Recruitment_ID[pos.camp] <- campid2
##We confirmed that all of the CAMP arrays now have ABRIDGE IDs except for the pilot array described
##above.
esQC.raw$Recruitment_ID[which(esQC.raw$Study_Name == "CAMP")]
identical(es.raw$Hybridization_Name, esQC.raw$Hybridization_Name)
## [1] TRUE
##In the regular dataset, we replaced the CAMP recruitment IDs with the ABRIDGE IDs.
es.raw$Recruitment_ID <- esQC.raw$Recruitment_ID
es.raw$Recruitment_ID[which(es.raw$Study_Name == "CAMP")]
pDat <- pData(esQC.raw)
## [1] "Gender"
pDat2 <- merge(x = pDat, y = pheno, by.x = "Recruitment_ID", by.y = "Id", all.x = TRUE,
               suffixes = c(".meta", ""), sort = FALSE)
##We determined specifically which arrays had possible gender mismatches.
ttpos <- which(is.na(pDat2$Gender) == FALSE & pDat2$Gender != pDat2$Gender.meta)
##There were 2 arrays with discrepancies. They are shown below.
pDat2[ttpos, c("Recruitment_ID", "Study_Name", "Study_Center_Name", "Gender.meta",
               "Gender", "Hybridization_Name")]
##Information on these arrays was written to an external file.
ttpDat <- pDat2[ttpos, c("Recruitment_ID", "Study_Name", "Study_Center_Name",
                         "Gender.meta", "Gender", "Hybridization_Name")]
out.path <- "/proj/reilms/reilm0h/ABRIDGE_GeneExpr_Final/Output/"
out.file <- "gender_mismatch_metafile_questionnaire.csv"
write.table(ttpDat, file = paste(out.path, out.file, sep = ""), sep = ",", row.names = FALSE,
            col.names = TRUE)
##We then determined if the sets of hybridization names were identical in the merged and original phenotype
##datasets, which turned out to be FALSE.
ttpos <- match(pDat$Hybridization_Name, pDat2$Hybridization_Name)
##We determined whether the discrepancy was due to missing data in either input set, which turned out
##to be FALSE. We then re-ordered the two sets to match up.
pDat3 <- pDat2[ttpos, ]
##We confirmed the fact that the sets of hybridization names were now identical as TRUE.
pDat[1:2, 1:3]
## Tracking_Barcode
## ST-00062678_S-000531211_5452276022_A S-000531211_CA010447303MR
## ST-00062779_S-000531213_5452276022_B S-000531213_CA010447321MR
## Hybridization_Name
## ST-00062678_S-000531211_5452276022_A ST-00062678_S-000531211_5452276022_A
## ST-00062779_S-000531213_5452276022_B ST-00062779_S-000531213_5452276022_B
## Treatment_Type
## ST-00062678_S-000531211_5452276022_A Blood_Paxgene RNA
## ST-00062779_S-000531213_5452276022_B Blood_Paxgene RNA
pDat3[1:2, 1:3]
## Recruitment_ID Tracking_Barcode
## 1 501000551 S-000531211_CA010447303MR
## 2 501000047 S-000531213_CA010447321MR
## Hybridization_Name
## 1 ST-00062678_S-000531211_5452276022_A
## 2 ST-00062779_S-000531213_5452276022_B
##We replaced the missing row names from in the re-ordered merged phenotype data.
##row.names(pDat3) <- row.names(pDat)
##The column names for the new phenotype data are listed below.
colnames(pDat3)
##We replaced the original phenotype data with the new merged phenotype data including questionnaire
##data.
pData(es.raw) <- pDat3
pData(esQC.raw) <- pDat3
##The properties of the final merged data set are shown below as well as counts of arrays in the non-QC data
##by study name, tissue type, study center name, gender, pass/fail status, asthma status, and chip manifest.
es.raw
esQC.raw
##Finally, we exported the merged dataset as an R object for later application of QC and normalization steps.
LstCampChips1to60AbridgeChips1to163.pheno <- list(es.raw = es.raw, esQC.raw = esQC.raw)
out.file <- "LstCampChips1to60AbridgeChips1to163.pheno.rda"
save(LstCampChips1to60AbridgeChips1to163.pheno, file = paste(out.path, out.file,
                                                             sep = ""))
